Object subclass: #ColeccionLlamadas	instanceVariableNames: 'llamadas'	classVariableNames: ''	package: 'TP1'!!ColeccionLlamadas methodsFor: 'initialization' stamp: 'tomi 5/24/2022 15:18'!initialize llamadas := OrderedCollection new.! !!ColeccionLlamadas methodsFor: 'as yet unclassified' stamp: 'tomi 4/25/2022 22:26'!registrar: llamada(llamada conDuracionCero) ifTrue: [ DuracionInvalidaError signal ].llamadas add: llamada.! !!ColeccionLlamadas methodsFor: 'as yet unclassified' stamp: 'tomi 4/25/2022 18:55'!cantidad^ llamadas size.! !!ColeccionLlamadas methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 17:51'!costeTotal^ llamadas sum: [ :llamada | llamada coste ].! !!ColeccionLlamadas methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 14:15'!masCostosa(llamadas isEmpty ) ifTrue: [ ColeccionLlamadasVaciaError signal ].^ llamadas detectMax: [ :llamada | llamada coste ].! !Error subclass: #ColeccionLlamadasVaciaError	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1'!Object subclass: #DescuentoPorDuracion	instanceVariableNames: 'porcentaje'	classVariableNames: ''	package: 'TP1'!!DescuentoPorDuracion methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 18:29'!aplicarA: unMonto^ unMonto * porcentaje.! !!DescuentoPorDuracion methodsFor: 'accessing' stamp: 'tomi 5/25/2022 13:56'!porcentaje: unPorcentajeporcentaje := unPorcentaje.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!DescuentoPorDuracion class	instanceVariableNames: ''!!DescuentoPorDuracion class methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 18:30'!del: unPorcentaje|descuento|descuento := self new.descuento porcentaje: unPorcentaje.^ descuento.! !Exception subclass: #DuracionInvalidaError	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1'!Object subclass: #Horario	instanceVariableNames: 'hora'	classVariableNames: ''	package: 'TP1'!!Horario methodsFor: 'accessing' stamp: 'tomi 5/26/2022 11:29'!hora^ hora.! !!Horario methodsFor: 'accessing' stamp: 'tomi 5/26/2022 11:15'!hora: unaHorahora := unaHora.! !!Horario methodsFor: 'as yet unclassified' stamp: 'tomi 5/26/2022 11:09'!asignarTarifa(hora between: 8 and: 20)	ifTrue: [ ^ 0.2 ]	ifFalse: [ ^ 0.1 ].! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Horario class	instanceVariableNames: ''!!Horario class methodsFor: 'as yet unclassified' stamp: 'tomi 5/26/2022 11:15'!conHora: unaHora| horario |horario := self new.horario hora: unaHora.^ horario.! !Object subclass: #Llamada	instanceVariableNames: 'tarifa duracion horario descuento'	classVariableNames: ''	package: 'TP1'!!Llamada methodsFor: 'initialization' stamp: 'tomi 5/26/2022 11:27'!initialize 	super.	duracion := 0.	horario := Horario conHora: 0.	tarifa := 0.	descuento := DescuentoPorDuracion del: 0.! !!Llamada methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 16:21'!conDuracionCero^ duracion isZero.! !!Llamada methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 19:04'!coste|costeLlamada|costeLlamada := tarifa * duracion.^ costeLlamada - (descuento aplicarA: costeLlamada).! !!Llamada methodsFor: 'as yet unclassified' stamp: 'tomi 4/23/2022 19:53'!descripcion! !!Llamada methodsFor: 'accessing' stamp: 'tomi 4/22/2022 15:50'!tarifa: tarifaPorMinutotarifa := tarifaPorMinuto.! !!Llamada methodsFor: 'accessing' stamp: 'tomi 5/25/2022 20:30'!descuento: unDescuentodescuento := unDescuento.! !!Llamada methodsFor: 'accessing' stamp: 'tomi 4/22/2022 13:19'!duracion: duracionDeLaLlamadaduracion := duracionDeLaLlamada.! !!Llamada methodsFor: 'accessing' stamp: 'tomi 5/26/2022 11:13'!horario: horarioDeLaLlamadahorario := (Horario conHora: horarioDeLaLlamada).! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Llamada class	instanceVariableNames: ''!!Llamada class methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 20:32'!inicializarConDuracion: duracionLlamada YHorario: horaLlamada| llamada |llamada := self new.llamada duracion: duracionLlamada.llamada horario: horaLlamada.(duracionLlamada >= 30) ifTrue: [ llamada descuento: (DescuentoPorDuracion del: 0.10) ].^ llamada.! !Llamada subclass: #LlamadaInternacional	instanceVariableNames: 'pais'	classVariableNames: ''	package: 'TP1'!!LlamadaInternacional methodsFor: 'accessing' stamp: 'tomi 4/22/2022 11:35'!pais: paisDestinoDeLaLllamadapais := paisDestinoDeLaLllamada.! !!LlamadaInternacional methodsFor: 'as yet unclassified' stamp: 'tomi 5/26/2022 11:30'!descripcion^ 'La llamada se hizo a ',pais,' a las ',horario hora asString,' hs durando ',duracion asString,' minutos'.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!LlamadaInternacional class	instanceVariableNames: ''!!LlamadaInternacional class methodsFor: 'as yet unclassified' stamp: 'tomi 4/23/2022 23:19'!conDuracion: duracionLlamada ALas: horaLlamada Hacia: paisDestinoDeLaLllamada YTarifaPorMinuto: tarifaInternacionalPorMinuto| llamada |llamada := self inicializarConDuracion: duracionLlamada YHorario: horaLlamada.llamada pais: paisDestinoDeLaLllamada.llamada tarifa: tarifaInternacionalPorMinuto.^ llamada.! !Llamada subclass: #LlamadaNacional	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1'!!LlamadaNacional methodsFor: 'as yet unclassified' stamp: 'tomi 5/26/2022 11:19'!asignarTarifaSegunHorario: horaLlamada	tarifa := horario asignarTarifa ! !!LlamadaNacional methodsFor: 'as yet unclassified' stamp: 'tomi 5/26/2022 11:31'!descripcion^ 'La llamada se hizo a las ',horario hora asString,' hs durando ',duracion asString,' minutos'.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!LlamadaNacional class	instanceVariableNames: ''!!LlamadaNacional class methodsFor: 'as yet unclassified' stamp: 'tomi 5/25/2022 16:09'!conDuracion: duracionLlamada ALas: horaLlamada| llamadaNacional |llamadaNacional := self inicializarConDuracion: duracionLlamada YHorario: horaLlamada.llamadaNacional asignarTarifaSegunHorario: horaLlamada.^ llamadaNacional.! !Object subclass: #TeleAlgo	instanceVariableNames: 'abonoMensual llamadas tarifaInternacionalPorMinuto'	classVariableNames: ''	package: 'TP1'!!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/23/2022 19:01'!calcularGastoFinal^ abonoMensual + llamadas costeTotal.! !!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/22/2022 18:39'!aplicarTarifaPorMinutoALlamadaInternacional: tarifaInternacional	tarifaInternacionalPorMinuto := tarifaInternacional.! !!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/25/2022 18:55'!llamadasEfectuadas^ llamadas cantidad.! !!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/24/2022 21:51'!consultarPorLlamadaEfectuadaMasCostosa[	^ 'La llamada mas costosa: ', llamadas masCostosa descripcion.	]	on: ColeccionLlamadasVaciaError do: [ 		^ 'No hay llamadas registradas'.	]! !!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/25/2022 23:10'!registrarLlamadaNacionalConDuracion: duracion HechaEnElHorario: horario	[ 	llamadas registrar: (LlamadaNacional conDuracion: duracion ALas: horario) 	] on: DuracionInvalidaError do: [ "La llamada con duracion 0 no es registrada" ].! !!TeleAlgo methodsFor: 'as yet unclassified' stamp: 'tomi 4/25/2022 23:09'!registrarLlamadaInternacionalCon: duracion HechaEnElHorario: horario Hacia: pais	[ 	llamadas registrar: (LlamadaInternacional conDuracion: duracion ALas: horario Hacia: pais YTarifaPorMinuto: tarifaInternacionalPorMinuto) 	] on: DuracionInvalidaError do: [ "La llamada con duracion 0 no es registrada" ].! !!TeleAlgo methodsFor: 'initialization' stamp: 'tomi 4/23/2022 18:59'!initialize	super.	abonoMensual := 0.	llamadas := ColeccionLlamadas new.	tarifaInternacionalPorMinuto := 1.! !!TeleAlgo methodsFor: 'accessing' stamp: 'tomi 4/17/2022 14:42'!abonoMensual: abonoabonoMensual := abono.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!TeleAlgo class	instanceVariableNames: ''!!TeleAlgo class methodsFor: 'as yet unclassified' stamp: 'tomi 4/22/2022 11:37'!conAbonoMensual: abono| teleAlgo |teleAlgo := self new.teleAlgo abonoMensual: abono.^ teleAlgo.! !